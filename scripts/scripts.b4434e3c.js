!function(){"use strict";angular.module("pattyApp.three",[]).constant("THREE",THREE),angular.module("pattyApp.potree",[]).constant("Potree",Potree).constant("POCLoader",POCLoader),angular.module("pattyApp",["ngAnimate","ngSanitize","ngTouch","ui.bootstrap","pattyApp.logos","pattyApp.searchbox","pattyApp.minimap","pattyApp.measuring","pattyApp.settings","pattyApp.help","pattyApp.cameramodes","pattyApp.pointcloud","pattyApp.extract"]).run(["DrivemapService",function(a){a.load()}]),angular.module("pattyApp.templates",[]),angular.module("pattyApp.logos",[]),angular.module("pattyApp.extract",["toastr","pattyApp.core","angular-loading-bar"]),angular.module("pattyApp.utils",["pattyApp.templates"]),angular.module("pattyApp.core",["pattyApp.utils"]),angular.module("pattyApp.minimap",["pattyApp.core"]),angular.module("pattyApp.measuring",["pattyApp.potree","pattyApp.three"]),angular.module("pattyApp.pointcloud",["pattyApp.core","pattyApp.potree","pattyApp.three","pattyApp.measuring","cfp.loadingBar"]),angular.module("pattyApp.settings",["pattyApp.pointcloud"]),angular.module("pattyApp.help",["pattyApp.templates"]),angular.module("pattyApp.cameramodes",["pattyApp.pointcloud"]),angular.module("pattyApp.searchbox",["pattyApp.core","pattyApp.pointcloud","toastr"])}(),function(){"use strict";function a(a){this.publish=function(){return a.$emit.apply(a,arguments)},this.subscribe=function(){return a.$on.apply(a,arguments)}}a.$inject=["$rootScope"],angular.module("pattyApp.utils").service("Messagebus",a)}(),function(){"use strict";function a(){return function(a,b){return b=+b,a.slice(b)}}angular.module("pattyApp.utils").filter("startFrom",a)}(),function(){"use strict";function a(a){this.bingMapsKey="Am6kAyf_AScih8y3ElNRSDpQ9xMJ8jn4yeePDKdHzhsNU4u7Jm-Ac8LJooYKmhbY",this.culture="nl",this.boundingBox={minlon:3.37,minlat:50.75,maxlon:7.21,maxlat:53.47},this.geocodeUrl=function(a){var b="http://dev.virtualearth.net/REST/v1/Locations?";return b+="jsonp=JSON_CALLBACK",b=b+"&q="+a,b=b+"&key="+this.bingMapsKey,this.culture&&(b=b+"&c="+this.culture),b},this.geocode=function(b){var c=this.geocodeUrl(b),d=this.boundingBox;return a.jsonp(c).then(function(a){var b=a.data.resourceSets[0].resources,c=b.filter(function(a){var b=a.point.coordinates[0],c=a.point.coordinates[1];return d.minlat<=b&&b<=d.maxlat&&d.minlon<=c&&c<=d.maxlon});return c})}}a.$inject=["$http"],angular.module("pattyApp.utils").service("BingGeoCoderService",a)}(),function(){"use strict";angular.module("pattyApp.core").constant("proj4",proj4).constant("pattyConf",{DRIVEMAP_JSON_URL:"data/drivemap.json",AHN_API_ENDPOINT:"http://localhost/ahn-pointcloud-viewer/api"})}(),function(){"use strict";function a(a,b,c,d,e){var f=this;this.data={};var g=b.defer();this.ready=g.promise,this.load=function(){return a.get(e.DRIVEMAP_JSON_URL).success(this.onLoad).error(this.onLoadFailure)},this.onLoad=function(a){f.data=a,f.registerProj4(),g.resolve(a)},this.onLoadFailure=function(){c.log("Failed to load drive map!!"),g.reject.apply(this,arguments)},this.registerProj4=function(){d.defs(this.getCrs(),this.data.features[0].properties.proj4)},this.getPointcloudUrl=function(){return this.data.features[0].properties.pointcloud},this.getCameraPath=function(){return this.data.features[0].geometry.coordinates},this.getLookPath=function(){return this.data.features[0].properties.lookatpath},this.getCrs=function(){return this.data.crs.properties.name}}a.$inject=["$http","$q","$log","proj4","pattyConf"],angular.module("pattyApp.core").service("DrivemapService",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/logos/logos.directive.html"}}angular.module("pattyApp.logos").directive("logoBoxDirective",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/searchbox/searchbox.directive.html",controller:"SearchPanelController",controllerAs:"sp"}}angular.module("pattyApp.searchbox").directive("pattySearchPanel",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){this.query="",this.bingMapsKey="Am6kAyf_AScih8y3ElNRSDpQ9xMJ8jn4yeePDKdHzhsNU4u7Jm-Ac8LJooYKmhbY",this.hasGeoLocation="geolocation"in e.navigator,this.clear=function(){this.query=""},this.onLocationResponse=function(a){if(0===a.length)return void f.warning("No results","Location not found");var b=a[0];this.query=b.name.replace(", Nederland","");var c=b.point.coordinates;this.gotoLocation(c[1],c[0])},this.search=function(){a.geocode(this.query).then(this.onLocationResponse.bind(this),function(){f.error("Search failed","for some reason")})},this.onQueryKeyPress=function(a){var b=13;a.keyCode===b&&this.search()},this.gotoLocation=function(a,d){var e=0,f="EPSG:4326",i=[a,d],j="EPSG:28992",k=h(f,j,i),l=new g.Vector3(k[0],k[1],e),m=b.toLocal(l),n=0,o=-1e3,p=1e3,q=[k[0]+n,k[1]+o],r=b.toLocal(new g.Vector3(q[0],q[1],e+p));c.moveTo(r),c.lookat(m)},this.gotoCurrentLocation=function(){e.navigator.geolocation.getCurrentPosition(function(a){var b=a.coords;this.gotoLocation(b.longitude,b.latitude)},function(){f.error("Unable to get current location")})}}a.$inject=["BingGeoCoderService","SceneService","PathControls","Messagebus","$window","toastr","THREE","proj4"],angular.module("pattyApp.searchbox").controller("SearchPanelController",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/settings/settings.directive.html",controller:"SettingsController",controllerAs:"sc"}}angular.module("pattyApp.settings").directive("pattySettings",a)}(),function(){"use strict";function a(a,b,c){this.showSettings=!1,this.settings=a.settings,this.PointcloudService=a,this.measure=c,this.recordCameraLocation=function(){b.recordLocation()}}a.$inject=["PointcloudService","CameraService","MeasuringService"],angular.module("pattyApp.settings").controller("SettingsController",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/help/help.directive.html",controller:"HelpController",controllerAs:"hc"}}angular.module("pattyApp.help").directive("pattyHelp",a)}(),function(){"use strict";function a(){this.showHelp=!1}angular.module("pattyApp.help").controller("HelpController",a)}(),function(){"use strict";angular.module("pattyApp.minimap").constant("ol",ol)}(),function(){"use strict";function a(a,b,c){var d="urn:ogc:def:crs:EPSG::28992",e=null;c.ready.then(function(){e=c.getCrs()}),this.camFrustum=new a.geom.LineString([[0,0],[0,0]]);var f=new a.source.Vector({features:[new a.Feature(this.camFrustum)]});this.layer=new a.layer.Vector({source:f,style:new a.style.Style({stroke:new a.style.Stroke({color:"#FFFFFF",width:2})})}),this.getExtent=function(){return f.getExtent()},this.getCameraPosition=function(){return this.camFrustum.getFirstCoordinate()},this.onCameraMove=function(a){var c=b(e,d,[a.cam.x,a.cam.y]),f=b(e,d,[a.left.x,a.left.y]),g=b(e,d,[a.right.x,a.right.y]);this.camFrustum.setCoordinates([c,f,g,c])}}a.$inject=["ol","proj4","DrivemapService"],angular.module("pattyApp.minimap").service("CamFrustumService",a)}(),function(){"use strict";function a(){return{restrict:"E",link:function(a,b){a.vm.map.setTarget(b[0])},controller:"MinimapController",controllerAs:"vm"}}angular.module("pattyApp.minimap").directive("pattyMinimap",a)}(),function(){"use strict";function a(a,b,c,d){b.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs");for(var e=new a.proj.Projection("EPSG:28992"),f=[-285401.92,22598.08,595401.9199999999,903401.9199999999],g=[3440.64,1720.32,860.16,430.08,215.04,107.52,53.76,26.88,13.44,6.72,3.36,1.68,.84,.42],h=new Array(14),i=0;15>i;++i)h[i]="EPSG:28992:"+i;for(var j=new Array(14),k=0;15>k;++k)j[k]=10>k?"0"+k:""+k;var l=a.proj.get("EPSG:28992");l.setExtent([646.36,308975.28,276050.82,636456.31]);var m=a.proj.transform([4.451,51.777],"EPSG:4326","EPSG:28992");this.osmLayer={};var n=new a.layer.Group({title:"Base maps",layers:[new a.layer.Tile({title:"NederlandBRT",type:"base",visible:!1,extent:f,source:new a.source.WMTS({url:"http://geodata.nationaalgeoregister.nl/tiles/service/wmts/brtachtergrondkaart",layer:"brtachtergrondkaart",matrixSet:"EPSG:28992",format:"image/png",projection:e,tileGrid:new a.tilegrid.WMTS({origin:a.extent.getTopLeft(f),resolutions:g,matrixIds:h})})}),this.osmLayer=new a.layer.Tile({title:"Luchtfotos",type:"base",visible:!0,source:new a.source.WMTS({url:"http://geodata1.nationaalgeoregister.nl/luchtfoto/wmts",layer:"luchtfoto",matrixSet:"nltilingschema",format:"image/jpeg",projection:e,tileGrid:new a.tilegrid.WMTS({origin:a.extent.getTopLeft(f),resolutions:g,matrixIds:j}),style:"default"})})]});this.map=new a.Map({maxExtent:f,layers:n,theme:null,maxResolution:860.16,numZoomLevels:12,units:"m",displayProjection:e,view:new a.View({center:m,zoom:14})}),this.setupResizeControl=function(){function b(b){var c=b||{},d=document.createElement("button");d.innerHTML='<span class="glyphicon glyphicon-resize-full"></span>';var e=this,f=!1,g=function(){f=!f,f?(e.getMap().getTarget().classList.add("big-minimap"),d.innerHTML='<span class="glyphicon glyphicon-resize-small"></span>'):(e.getMap().getTarget().classList.remove("big-minimap"),d.innerHTML='<span class="glyphicon glyphicon-resize-full"></span>'),e.getMap().updateSize()};d.addEventListener("click",g,!1),d.addEventListener("touchstart",g,!1);var h=document.createElement("div");h.className="resize-minimap ol-unselectable ol-control",h.appendChild(d),a.control.Control.call(this,{element:h,target:c.target})}a.inherits(b,a.control.Control),this.map.addControl(new b)},this.setupResizeControl();var o=new a.control.LayerSwitcher({tipLabel:"Legend"});this.map.addControl(o),this.map.addLayer(c.layer),this.centerMap=function(a){this.map.getView().setCenter(a)},this.updateFrustrumAndCenterMap=function(a,b){c.onCameraMove(b);var d=c.getCameraPosition();this.centerMap(d)},d.subscribe("cameraMoved",this.updateFrustrumAndCenterMap.bind(this))}a.$inject=["ol","proj4","CamFrustumService","Messagebus"],angular.module("pattyApp.minimap").controller("MinimapController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(b){var c=new a.PerspectiveCamera(75,d.innerWidth/d.innerHeight,1,1e5);r=new a.Camera;var e=new a.Scene,f=".jpg",g=[b+"px"+f,b+"nx"+f,b+"py"+f,b+"ny"+f,b+"pz"+f,b+"nz"+f],h=a.ImageUtils.loadTextureCube(g,new a.CubeRefractionMapping),i=a.ShaderLib.cube;i.uniforms.tCube.value=h;var j=new a.ShaderMaterial({fragmentShader:i.fragmentShader,vertexShader:i.vertexShader,uniforms:i.uniforms,depthWrite:!1,side:a.BackSide}),k=new a.Mesh(new a.BoxGeometry(1e5,1e5,1e5),j);return e.add(k),{camera:c,scene:e}}function m(){var c=new a.Vector3(w.x,w.y,.5);c.unproject(q);var d=c.sub(q.position).normalize(),e=new a.Ray(q.position,d),f=[];s.traverse(function(a){a instanceof b.PointCloudOctree&&f.push(a)});for(var g=null,h=null,i=0;i<f.length;i++){var j=f[i],k=j.pick(p.renderer,q,e,{accuracy:.5});if(k){var l=q.position.distanceTo(k.position);(!g||h>l)&&(g=k,h=l)}}return g?g.position:null}function n(){if(p.settings.showStats){t?(p.stats.nrPoints=t.numVisiblePoints,p.stats.nrNodes=t.numVisibleNodes):(p.stats.nrPoints="none",p.stats.nrNodes="none");var a=m();if(a){var b=a;p.stats.sceneCoordinates.x=b.x.toFixed(2),p.stats.sceneCoordinates.y=b.y.toFixed(2),p.stats.sceneCoordinates.z=b.z.toFixed(2);var c=h.toGeo(b);p.stats.lasCoordinates.x=c.x.toFixed(2),p.stats.lasCoordinates.y=c.y.toFixed(2),p.stats.lasCoordinates.z=c.z.toFixed(2)}e.$digest()}}function o(a){w.x=a.clientX/p.renderer.domElement.clientWidth*2-1,w.y=2*-(a.clientY/p.renderer.domElement.clientHeight)+1}var p=this;this.elRenderArea=null,p.settings={pointCountTarget:5,pointSize:.01,opacity:1,showSkybox:!0,interpolate:!0,showStats:!1,highQuality:!1,showBoundingBox:!1,pointSizeType:b.PointSizeType.ADAPTIVE,pointSizeTypes:b.PointSizeType,pointColorType:b.PointColorType.HEIGHT,pointColorTypes:b.PointColorType,pointShapes:b.PointShape,pointShape:b.PointShape.CIRCLE,clipMode:b.ClipMode.HIGHLIGHT_INSIDE,clipModes:b.ClipMode},p.stats={nrPoints:0,nrNodes:0,sceneCoordinates:{x:0,y:0,z:0},lasCoordinates:{x:0,y:0,z:0,crs:"unknown"}},this.renderer=null;var q,r,s,t,u;p.pathMesh=null;var v=h.referenceFrame,w={x:0,y:0};this.orbitControls=null,this.isInOrbitMode=!1;var x=new b.PointCloudMaterial;this.initThree=function(){var b=d.innerWidth,c=d.innerHeight;s=h.getScene(),q=g.camera,p.renderer=new a.WebGLRenderer,p.renderer.setSize(b,c),p.renderer.autoClear=!1,p.renderer.domElement.addEventListener("mousemove",o,!1),j.init(p.renderer,s,q),u=l("images/skybox/"),p.renderer.context.getExtension("EXT_frag_depth"),f.ready.then(this.loadPointcloud)},this.loadPointcloud=function(){var d=f.getPointcloudUrl();p.stats.lasCoordinates.crs=f.getCrs(),c.load(d,function(c){t=new b.PointCloudOctree(c,x),t.material.pointSizeType=b.PointSizeType.ADAPTIVE,t.material.size=p.settings.pointSize,t.visiblePointsTarget=1e3*p.settings.pointCountTarget*1e3,v.add(t),v.updateMatrixWorld(!0),v.position.set(-t.position.x,-t.position.y,0),v.updateMatrixWorld(!0),v.applyMatrix((new a.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),v.updateMatrixWorld(!0);{var d=f.getCameraPath().map(function(b){return h.toLocal(new a.Vector3(b[0],b[1],b[2]))}),e=f.getLookPath().map(function(b){return h.toLocal(new a.Vector3(b[0],b[1],b[2]))}),g=79692.68,k=96258.93,l=383917.51,m=422503.12,n=h.toLocal(new a.Vector3(g,m,0)),o=h.toLocal(new a.Vector3(k,l,0));o.x-n.x,o.z-n.z}console.log(n),console.log(o),i.init(q,d,e,p.elRenderArea),p.pathMesh=i.createPath(),s.add(p.pathMesh),p.pathMesh.visible=!1,j.setPointcloud(t)})},this.disableDrivemap=function(){v.remove(t)},this.enableDrivemap=function(){v.add(t)},this.update=function(){if(t){t.material.clipMode=p.settings.clipMode,t.material.size=p.settings.pointSize,t.visiblePointsTarget=1e3*p.settings.pointCountTarget*1e3,t.material.opacity=p.settings.opacity,t.material.pointSizeType=p.settings.pointSizeType,t.material.pointColorType=p.settings.pointColorType,t.material.pointShape=p.settings.pointShape,t.material.interpolate=p.settings.interpolate,t.material.heightMin=0,t.material.heightMax=8,t.material.intensityMin=0,t.material.intensityMax=65e3,t.material.minSize=2,t.showBoundingBox=p.settings.showBoundingBox,t.update(q,p.renderer);var a=t.visibleNodes.length/t.visibleGeometry.length,b=k.status();1===a&&1>b?k.complete():1>a&&a!==b?(k.start(),k.set(a)):a===1/0&&1>b&&k.complete()}else k.start();p.isInOrbitMode?p.orbitControls.update():i.updateInput(),j.update(),g.update(),n()},this.render=function(){if(t){t.originalMaterial&&(t.material=t.originalMaterial);var a=d.innerWidth,b=d.innerHeight;p.renderer.setSize(a,b),p.settings.showSkybox&&(u.camera.rotation.copy(q.rotation),p.renderer.render(u.scene,u.camera)),p.renderer.render(s,q),j.render()}};var y,z,A,B=new a.WebGLRenderTarget(1024,1024,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.FloatType}),C=new a.WebGLRenderTarget(1024,1024,{minFilter:a.LinearFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.FloatType});this.renderHighQuality=function(){if(!y){y=new a.Scene;var c=document.getElementById("vs").innerHTML,e=document.getElementById("fs").innerHTML,f={depthMap:{type:"t",value:B},texture:{type:"t",value:C}},g=new a.ShaderMaterial({uniforms:f,vertexShader:c,fragmentShader:e}),h=new a.Mesh(new a.PlaneBufferGeometry(2,2,0),g);h.material.depthTest=!0,h.material.depthWrite=!0,h.material.transparent=!0,y.add(h),y.screenQuad=h}B&&(B.width!==d.innerWidth||B.height!==d.innerHeight)&&(B.dispose(),C.dispose(),B=new a.WebGLRenderTarget(1024,1024,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.FloatType}),C=new a.WebGLRenderTarget(1024,1024,{minFilter:a.LinearFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.FloatType}),y.screenQuad.material.uniforms.depthMap.value=B,y.screenQuad.material.uniforms.texture.value=C);var i=d.innerWidth,k=d.innerHeight,l=i/k;q.aspect=l,q.updateProjectionMatrix(),p.renderer.setSize(i,k),B.setSize(i,k),C.setSize(i,k),p.renderer.clear(),u.camera.rotation.copy(q.rotation),p.renderer.render(u.scene,u.camera),p.renderer.render(s,q),t&&(A||(t.originalMaterial=t.material,z=new b.PointCloudMaterial,A=new b.PointCloudMaterial),t.material=z,t.material.size=p.settings.pointSize,t.visiblePointsTarget=1e3*p.settings.pointCountTarget*1e3,t.material.opacity=p.settings.opacity,t.material.pointSizeType=p.settings.pointSizeType,t.material.pointColorType=b.PointColorType.DEPTH,t.material.pointShape=b.PointShape.CIRCLE,t.material.interpolate=!0,t.material.weighted=!1,t.material.minSize=2,t.material.screenWidth=i,t.material.screenHeight=k,t.update(q,p.renderer),p.renderer.clearTarget(B,!0,!0,!0),p.renderer.clearTarget(C,!0,!0,!0),p.renderer.render(s,q,B),t.material=A,t.material.size=p.settings.pointSize,t.visiblePointsTarget=1e3*p.settings.pointCountTarget*1e3,t.material.opacity=p.settings.opacity,t.material.pointSizeType=p.settings.pointSizeType,t.material.pointColorType=p.settings.pointColorType,t.material.pointShape=b.PointShape.CIRCLE,t.material.interpolate=!1,t.material.weighted=!0,t.material.minSize=2,t.material.depthMap=B,t.material.blendDepth=Math.min(t.material.spacing,20),t.update(q,p.renderer),p.renderer.render(s,q,C),p.renderer.render(y,r),p.renderer.clearDepth(),j.render())},this.loop=function(){requestAnimationFrame(p.loop),p.update(),p.settings.highQuality?p.renderHighQuality():p.render()},this.attachCanvas=function(a){p.elRenderArea=a,p.initThree();var b=p.renderer.domElement;a.appendChild(b),p.loop()}}a.$inject=["THREE","Potree","POCLoader","$window","$rootScope","DrivemapService","CameraService","SceneService","PathControls","MeasuringService","cfpLoadingBar"],angular.module("pattyApp.pointcloud").service("PointcloudService",a)}(),function(){"use strict";function a(a){var b=new a.Scene;this.referenceFrame=new a.Object3D,b.add(this.referenceFrame),this.getScene=function(){return b},this.toLocal=function(a){var b=a.clone().applyMatrix4(this.referenceFrame.matrixWorld);return b},this.toGeo=function(b){var c,d=(new a.Matrix4).getInverse(this.referenceFrame.matrixWorld);if(b instanceof a.Vector3)c=b.clone().applyMatrix4(d);else if(b instanceof a.Box3){var e=b.min.clone().applyMatrix4(d),f=b.max.clone().applyMatrix4(d);c=new a.Box3(e,f)}return c}}a.$inject=["THREE"],angular.module("pattyApp.pointcloud").service("SceneService",a)}(),function(){"use strict";function a(a,b,c,d,e){var f=this,g=75,h=a.innerWidth,i=a.innerHeight,j=h/i,k=.1,l=1e5;this.camera=new c.PerspectiveCamera(g,j,k,l),this.toGeo=null,this.waypoints=[],a.addEventListener("resize",function(){f.onWindowResize()}),this.recordLocation=function(){this.waypoints.push(e.toGeo(this.camera.position.clone()).toArray()),b.log(JSON.stringify(this.waypoints))},this.getCameraOrientation=function(){return(new c.Matrix4).multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorld).determinant()};var m=this.getCameraOrientation();this.update=function(){var a=this.getCameraOrientation();a!==m&&this.update2DFrustum(),m=a},this.update2DFrustum=function(){var a=this.camera,b=a.aspect,f=Math.tan(c.Math.degToRad(.5*a.fov))*a.near,g=-f,h=b*g,i=b*f,j=new c.Vector3(0,0,0);h=new c.Vector3(h,0,-a.near).multiplyScalar(3e3),i=new c.Vector3(i,0,-a.near).multiplyScalar(3e3),j.applyMatrix4(a.matrixWorld),h.applyMatrix4(a.matrixWorld),i.applyMatrix4(a.matrixWorld),j=e.toGeo(j),h=e.toGeo(h),i=e.toGeo(i),d.publish("cameraMoved",{cam:j,left:h,right:i})},this.onWindowResize=function(){var b=a.innerWidth,c=a.innerHeight,d=b/c;this.camera.aspect=d,this.camera.updateProjectionMatrix()}}a.$inject=["$window","$log","THREE","Messagebus","SceneService"],angular.module("pattyApp.pointcloud").service("CameraService",a)}(),function(){"use strict";function a(a,b){var c,d=Number.MAX_VALUE,e=0,f=0;for(c=0;c<a.points.length;c++)e=b.distanceTo(a.points[c]),d>e&&(d=e,f=c);return f}function b(b,c){var d=a(b,c),e=Number.MAX_VALUE,f=Number.MAX_VALUE,g=1;0!==d&&(e=c.distanceTo(b.points[d-1])),d<b.points.length-1&&(f=c.distanceTo(b.points[d+1])),e>f?g=d+1:(d-=1,g=d+1);var h=c.clone();h.sub(b.points[d]);var i=b.points[g].clone();i.sub(b.points[d].clone()),i.normalize();var j=h.dot(i)/h.length();return(d+j)/b.points.length*R}function c(a,b,c){var d,e,f;d=new B.SphereGeometry(.5,32,32),e=new B.MeshBasicMaterial({color:c});for(var g=0;g<b.length;g++)f=new B.Mesh(d,e),f.position.copy(b[g]),a.add(f)}function d(a){return Math.min(Math.max(a,0),1)}function e(a){var b=new B.Vector3(Math.sin(G),Math.sin(-H),Math.cos(G));return b.multiplyScalar(-a)}function f(a){var b=new B.Vector3(Math.cos(-G),0,Math.sin(-G));return b.multiplyScalar(-a)}function g(){H=Math.max(Math.min(H,I),J),v.rotation.set(H,G,0,"YXZ")}function h(a){(N[87]||N[38])&&(Q+=a),(N[83]||N[40])&&(Q-=a),Q%=R,0>Q&&(Q=R+Q),v.position.copy(x.getPointAt(Q/R))}function i(a){(N[87]||N[119]||N[38])&&A.add(e(a)),(N[83]||N[115]||N[40])&&A.sub(e(a))}function j(a){(N[90]||N[122])&&(A.y-=a),(N[81]||N[113])&&(A.y+=a)}function k(a){(N[65]||N[97]||N[37])&&A.add(a),(N[68]||N[100]||N[39])&&A.sub(a)}function l(a){i(a),j(a),k(f(a))}function m(){var a=1,c=b(y,A)/y.points.length,d=b(x,A)/x.points.length;return 0!==d&&0!==c&&(a=Math.max(d,c)/Math.min(d,c)),a}function n(a){N[a.keyCode]=!0;var b=32;a.keyCode===b&&a.preventDefault()}function o(a){N[a.keyCode]=!1}function p(){E=!1;var a;for(a=0;a<N.length;a++)N[a]=!1}function q(a){2===a.button&&(document.activeElement!==z&&z.focus(),a.preventDefault(),K=a.pageX,L=a.pageY,E=!0)}function r(a){2===a.button&&(a.preventDefault(),E=!1)}function s(a){E&&(G-=M*(a.pageX-K)/window.innerWidth,H-=M*(a.pageY-L)/window.innerHeight,K=a.pageX,L=a.pageY)}function t(a){a.preventDefault(),a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),0>b?O+=2.5:O-=2.5,O>P&&(O=P),5>O&&(O=5),v.fov=O,v.updateProjectionMatrix()}var u,v,w,x,y,z,A,B,C=30,D=10,E=!1,F=1.08,G=0,H=0,I=.95*Math.PI/2,J=-.95*Math.PI/2,K=window.innerWidth/2,L=window.innerHeight/2,M=8,N=[],O=45,P=45,Q=0,R=240,S=function(a){B=a.THREE,u=this;for(var b=0;130>b;b++)N.push(!1);this.camera=null,this.path=null,w=new B.Clock,this.modes={ONRAILS:"onrails",FLY:"fly",DEMO:"demo",OFF:"off"},this.mode=this.modes.FLY};S.$inject=["$window"],S.prototype.initCamera=function(a,b){this.camera=a,v=a,v.position.copy(b),v.up.set(0,1,0),v.rotation.order="YXZ",A=v.position,O=v.fov,P=v.fov},S.prototype.initListeners=function(a){z=a,a.setAttribute("tabindex",1),a.addEventListener("keydown",n,!1),a.addEventListener("keyup",o,!1),a.addEventListener("mouseleave",p,!1),a.addEventListener("mouseout",p,!1),a.addEventListener("mousemove",s,!1),a.addEventListener("mousedown",q,!1),a.addEventListener("mouseup",r,!1),a.addEventListener("mousewheel",t,!1),a.addEventListener("DOMMouseScroll",t,!1)},S.prototype.disableListeners=function(a){a.removeEventListener("keydown",n,!1),a.removeEventListener("keyup",o,!1),a.removeEventListener("mouseleave",p,!1),a.removeEventListener("mouseout",p,!1),a.removeEventListener("mousemove",s,!1),a.removeEventListener("mousedown",q,!1),a.removeEventListener("mouseup",r,!1),a.removeEventListener("mousewheel",t,!1),a.removeEventListener("DOMMouseScroll",t,!1)},S.prototype.init=function(a,b,c,d){var e=new B.SplineCurve3(c);y=new B.SplineCurve3(e.getSpacedPoints(100));var f=new B.SplineCurve3(b);x=new B.SplineCurve3(f.getSpacedPoints(100)),this.initCamera(a,x.getPointAt(0)),this.lookat(y.getPointAt(.05)),v.updateProjectionMatrix(),this.initListeners(d)},S.prototype.goToPointOnRoad=function(a){Q=b(x,a),A.copy(x.getPointAt(Q/R))},S.prototype.lookat=function(a){v.up=new B.Vector3(0,1,0),v.lookAt(a),G=v.rotation.y,H=v.rotation.x},S.prototype.moveTo=function(a){A.copy(a)},S.prototype.createPath=function(){var a=new B.TubeGeometry(x,1024,.25,8,!1),b=new B.TubeGeometry(y,1024,.25,8,!1),d=B.SceneUtils.createMultiMaterialObject(a,[new B.MeshLambertMaterial({color:65535}),new B.MeshBasicMaterial({color:65535,opacity:.3,wireframe:!1,transparent:!1})]),e=B.SceneUtils.createMultiMaterialObject(b,[new B.MeshLambertMaterial({color:255}),new B.MeshBasicMaterial({color:255,opacity:.3,wireframe:!1,transparent:!1})]);return d.add(e),c(d,x.points,16711680),c(d,y.points,65280),d},S.prototype.updateDemoMode=function(a){Q+=a,Q%=R,0>Q&&(Q=R+Q),v.position.copy(x.getPointAt(Q/R)),F=(1-a/3)*F+a/3*m();var b=Q/R*(y.getLength()/x.getLength())*F,c=y.getPointAt(d(b));this.lookat(c)},S.prototype.updateInput=function(){if(x){var a=w.getDelta();a*=C,N[32]&&(a*=D),g(),this.mode===this.modes.DEMO?this.updateDemoMode(a):this.mode===this.modes.FLY?l(10*a):this.mode===this.modes.ONRAILS?h(a):this.mode===this.modes.OFF||console.log("error: unknown control mode in path.controls")}},S.prototype.enableFlightMode=function(){this.mode=this.modes.FLY},S.prototype.transitionFromFlightMode=function(){this.mode===this.modes.FLY&&this.goToPointOnRoad(A)},S.prototype.enableRailsMode=function(){this.transitionFromFlightMode(),this.mode=this.modes.ONRAILS},S.prototype.enableDemoMode=function(){this.transitionFromFlightMode(),this.mode=this.modes.DEMO},angular.module("pattyApp.pointcloud").service("PathControls",S)}(),function(){"use strict";function a(){return{restrict:"E",link:function(a,b){a.vm.attachCanvas(b[0])},controller:"PointcloudCanvasController",controllerAs:"vm"}}angular.module("pattyApp.pointcloud").directive("pattyPointcloudCanvas",a)}(),function(){"use strict";function a(a){this.attachCanvas=function(b){a.attachCanvas(b)}}a.$inject=["PointcloudService"],angular.module("pattyApp.pointcloud").controller("PointcloudCanvasController",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/cameramodes/cameramodes.directive.html",controller:"CameramodesController",controllerAs:"cmc"}}angular.module("pattyApp.cameramodes").directive("pattyCameraModes",a)}(),function(){"use strict";function a(a,b,c){this.PathControls=b,this.cameraMode=b.mode,this.orbitModeEnabled=!1,c.subscribe("orbitModeEnabled",function(b,c){this.orbitModeEnabled=c,c&&(a.$$phase||a.$apply())}.bind(this)),this.exitOrbitMode=function(){c.publish("exitOrbitMode")}}a.$inject=["$rootScope","PathControls","Messagebus"],angular.module("pattyApp.cameramodes").controller("CameramodesController",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/pointcloud/pointcloud-stats.directive.html",controller:"PointcloudStatsController",controllerAs:"pcs"}}angular.module("pattyApp.pointcloud").directive("pattyPointcloudStats",a)}(),function(){"use strict";function a(a){this.stats=a.stats,this.settings=a.settings}a.$inject=["PointcloudService"],angular.module("pattyApp.pointcloud").controller("PointcloudStatsController",a)}(),function(){"use strict";function a(a,b,c,d){this.tools={measuring:null,volume:null,heightprofile:null,clipvolume:null,transformation:null},this.transformationTools={TRANSLATE:0,ROTATE:1,SCALE:2},this.activeTransformationTool=this.transformationTools.ROTATE,this.pointcloud=null,this.sitePointcloud=null,this.profileWidth=.1,this.initialized=!1,this.onKeyDown=function(b){69===b.keyCode?(this.activeTransformationTool=this.transformationTools.SCALE,a.$digest(),this.tools.transformation.scale()):82===b.keyCode?(this.activeTransformationTool=this.transformationTools.ROTATE,a.$digest(),this.tools.transformation.rotate()):84===b.keyCode&&(this.activeTransformationTool=this.transformationTools.TRANSLATE,a.$digest(),this.tools.transformation.translate())},this.clear=function(){this.clearStandardPotreeMeasurementTool(this.tools.measuring),this.clearVolumes(),this.clearProfile()},this.clearStandardPotreeMeasurementTool=function(a){a.measurements=[],a.sceneMeasurement=new c.Scene,a.sceneRoot=new c.Object3D,a.sceneMeasurement.add(a.sceneRoot),a.light=new c.DirectionalLight(16777215,1),a.light.position.set(0,0,10),a.light.lookAt(new c.Vector3(0,0,0)),a.sceneMeasurement.add(a.light)},this.clearVolumes=function(){this.tools.volume.volumes=[],this.tools.volume.sceneVolume=new c.Scene},this.clearProfile=function(){this.tools.heightprofile.profiles=[],this.tools.heightprofile.sceneProfile=new c.Scene,this.tools.heightprofile.sceneRoot=new c.Object3D,this.tools.heightprofile.sceneProfile.add(this.tools.heightprofile.sceneRoot)},this.init=function(a,c,e){this.tools.measuring=new b.MeasuringTool(c,e,a),this.tools.volume=new b.VolumeTool(c,e,a),this.tools.heightprofile=new b.ProfileTool(c,e,a),this.tools.transformation=new b.TransformationTool(c,e,a),d.transformationTool=this.tools.transformation,d.addEventListener("keydown",this.onKeyDown.bind(this),!1),this.initialized=!0},this.setPointcloud=function(a){this.pointcloud=a},this.setSitePointcloud=function(a){this.sitePointcloud=a},this.startDistance=function(){this.tools.measuring&&this.tools.measuring.startInsertion({showDistances:!0,showArea:!1,closed:!1})},this.startAngle=function(){this.tools.measuring&&this.tools.measuring.startInsertion({showDistances:!1,showAngles:!0,showArea:!1,closed:!0,maxMarkers:3})},this.startArea=function(){this.tools.measuring&&this.tools.measuring.startInsertion({showDistances:!0,showArea:!0,closed:!0})},this.startVolume=function(){this.tools.volume&&this.tools.volume.startInsertion()},this.startHeighProfile=function(){this.tools.heightprofile&&this.tools.heightprofile.startInsertion({width:this.profileWidth})},this.startClipVolume=function(){this.tools.volume&&this.tools.volume.startInsertion({clip:!0})},this.render=function(){this.initialized&&(this.tools.heightprofile.render(),this.tools.volume.render(),this.tools.measuring.renderer.clearDepth(),this.tools.measuring.render(),this.tools.transformation.render())},this.update=function(){if(this.initialized){this.tools.volume.update(),this.tools.transformation.update(),this.tools.heightprofile.update();for(var a=[],b=0;b<this.tools.heightprofile.profiles.length;b++)for(var d=this.tools.heightprofile.profiles[b],e=0;e<d.boxes.length;e++){var f=d.boxes[e];f.updateMatrixWorld();var g=(new c.Matrix4).getInverse(f.matrixWorld);a.push(g)}for(var h=0;h<this.tools.volume.volumes.length;h++){var i=this.tools.volume.volumes[h];if(i.clip){i.updateMatrixWorld();var j=(new c.Matrix4).getInverse(i.matrixWorld);a.push(j)}}this.pointcloud&&this.pointcloud.material.setClipBoxes(a),this.sitePointcloud&&this.sitePointcloud.material.setClipBoxes(a)}}}a.$inject=["$rootScope","Potree","THREE","$window"],angular.module("pattyApp.measuring").service("MeasuringService",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/measuring/measuring.directive.html",controller:"MeasuringController",controllerAs:"measuring"}}angular.module("pattyApp.measuring").directive("measuringDirective",a)}(),function(){"use strict";function a(a){this.showToolboxTray=!1,this.showTransformationToolboxTray=!1,this.distanceActive=!1,this.angleActive=!1,this.areaActive=!1,this.volumeActive=!1,this.heightProfileActive=!1,this.clipVolumeActive=!1,this.measuringService=a,this.toggleToolbox=function(){this.resetState(),this.showToolboxTray=!this.showToolboxTray,this.measuringService.clear()},this.resetState=function(){this.distanceActive=!1,this.angleActive=!1,this.areaActive=!1,this.volumeActive=!1,this.heightProfileActive=!1,this.clipVolumeActive=!1,this.showTransformationToolboxTray=!1},this.isTransformationRotate=function(){var a=!1;return this.measuringService.activeTransformationTool===this.measuringService.transformationTools.ROTATE&&(a=!0),a},this.isTransformationTranslate=function(){var a=!1;return this.measuringService.activeTransformationTool===this.measuringService.transformationTools.TRANSLATE&&(a=!0),a},this.isTransformationScale=function(){var a=!1;return this.measuringService.activeTransformationTool===this.measuringService.transformationTools.SCALE&&(a=!0),a},this.startDistance=function(){this.resetState(),this.distanceActive=!0,this.measuringService.startDistance()},this.startAngle=function(){this.resetState(),this.angleActive=!0,this.measuringService.startAngle()},this.startArea=function(){this.resetState(),this.areaActive=!0,this.measuringService.startArea();

},this.startAngle=function(){this.resetState(),this.angleActive=!0,this.measuringService.startAngle()},this.startVolume=function(){this.resetState(),this.volumeActive=!0,this.showTransformationToolboxTray=!0,this.measuringService.startVolume()},this.startHeightProfile=function(){this.resetState(),this.heightProfileActive=!0,this.measuringService.startHeightProfile()},this.startClipVolume=function(){this.resetState(),this.clipVolumeActive=!0,this.showTransformationToolboxTray=!0,this.measuringService.startClipVolume()},this.toggleRotate=function(){this.measuringService.activeTransformationTool=this.measuringService.transformationTools.ROTATE,this.resetState(),this.showTransformationToolboxTray=!0,this.measuringService.tools.transformation.rotate()},this.toggleTranslate=function(){this.measuringService.activeTransformationTool=this.measuringService.transformationTools.TRANSLATE,this.resetState(),this.showTransformationToolboxTray=!0,this.measuringService.tools.transformation.translate()},this.toggleScale=function(){this.measuringService.activeTransformationTool=this.measuringService.transformationTools.SCALE,this.resetState(),this.showTransformationToolboxTray=!0,this.measuringService.tools.transformation.scale()}}a.$inject=["MeasuringService"],angular.module("pattyApp.measuring").controller("MeasuringController",a)}(),function(){"use strict";function a(){return{lon1:93720.22,lat1:436899.97,lon2:94428.37,lat2:438334.32,toRequest:function(){var a={left:this.lon1,bottom:this.lat1,right:this.lon2,top:this.lat2};return this.lon1>this.lon2&&(a.left=this.lon2,a.right=this.lon1),this.lat1>this.lat2&&(a.bottom=this.lat2,a.top=this.lat1),a}}}angular.module("pattyApp.extract").factory("ExtractionSelectionService",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"scripts/extract/extraction.directive.html",controller:"ExtractionController",controllerAs:"ec"}}angular.module("pattyApp.extract").directive("extractionPanel",a)}(),function(){"use strict";function a(a,b,c,d){this.showForm=!1,this.selection=a,this.email="",this.size={},this.count=function(){var a=this.selection.toRequest(),d=b.AHN_API_ENDPOINT,e=d+"/size";c.post(e,a).success(function(a){this.size=a}.bind(this)).error(function(){console.log(arguments)})},this.submit=function(){var a=this.selection.toRequest();a.email=this.email,a.level=this.size.level||13;var e=b.AHN_API_ENDPOINT,f=e+"/laz";c.post(f,a).success(function(b){this.size=b,d.success('Will send e-mail to "'+a.email+'" when completed',"Point extraction job submitted")}.bind(this)).error(function(){console.log(arguments),d.error("Submit failed","for some reason")}),this.showForm=!1}}a.$inject=["ExtractionSelectionService","pattyConf","$http","toastr"],angular.module("pattyApp.extract").controller("ExtractionController",a)}(),angular.module("pattyApp.templates").run(["$templateCache",function(a){"use strict";a.put("scripts/cameramodes/cameramodes.directive.html",'<div class="camera-modes btn-group">\n  <button class="icon-big onrails-icon" ng-show="!cmc.orbitModeEnabled" ng-click="cmc.PathControls.enableRailsMode()" ng-model="cmc.cameraMode" btn-radio="\'onrails\'" title="On rails"></button>\n  <button class="icon-big fly-icon" ng-show="!cmc.orbitModeEnabled" ng-click="cmc.PathControls.enableFlightMode()" ng-model="cmc.cameraMode" btn-radio="\'fly\'" title="Free fly"></button>\n  <button class="icon-big demo-icon" ng-show="!cmc.orbitModeEnabled" ng-click="cmc.PathControls.enableDemoMode()" ng-model="cmc.cameraMode" btn-radio="\'demo\'" title="Demo mode"></button>\n\n  <button class="icon-big back-icon" ng-show="cmc.orbitModeEnabled" ng-click="cmc.exitOrbitMode()" title="Exit orbit mode"></button>\n</div>\n'),a.put("scripts/extract/extraction.directive.html",'<button ng-click="ec.showForm=!ec.showForm" ng-class="{active: ec.showForm}" class="icon-big extract-icon" title="Extract points"></button>\n<div collapse=\'!ec.showForm\' class="panel panel-default extract-panel">\n  <div class="panel-heading">Extract points\n    <button ng-click="ec.showForm=!ec.showForm" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  </div>\n  <div class="panel-body">\n    <form class="form-inline" role="search" name="extractForm">\n      <div class="form-group">\n        <label for="email">Email</label>\n        <input required type="email" ng-minlength="4" class="form-control" name="email" placeholder="" ng-model="ec.email" compute-selection-size>\n      </div>\n      <fieldset>\n        <div class="form-group">\n          <label for="lon1">Lon 1</label>\n          <input required type="number" step=0.01 class="form-control" name="lon1" placeholder="" ng-model="ec.selection.lon1">\n        </div>\n        <div class="form-group">\n          <label for="lat1">Lat 1</label>\n          <input required type="number" step=0.01 class="form-control" name="lat1" placeholder="" ng-model="ec.selection.lat1">\n        </div>\n      </fieldset>\n      <fieldset>\n        <div class="form-group">\n          <label for="lon2">Lon 2</label>\n          <input required type="number" step=0.01 class="form-control" name="lon2" placeholder="" ng-model="ec.selection.lon2">\n        </div>\n        <div class="form-group">\n          <label for="lat2">Lat 2</label>\n          <input required type="number" step=0.01 class="form-control" name="lat2" placeholder="" ng-model="ec.selection.lat2">\n        </div>\n      </fieldset>\n      <div >\n        Selected number of points:\n        <span>{{ec.size.points}}</span>\n        Level:\n        <span>{{ec.size.level}}</span>\n        Coverage (%):\n        <span>{{ec.size.coverage}}</span>\n      </div>\n      <button ng-click="ec.count()" type="submit" class="btn btn-default">Count points</button>\n      <button ng-disabled="extractForm.$invalid" ng-click="ec.submit()" type="submit" class="btn btn-primary">Submit</button>\n    </form>\n  </div>\n</div>\n'),a.put("scripts/help/help.directive.html",'<button ng-click="hc.showHelp=!hc.showHelp" class="icon-big help-icon" ng-class="{active: hc.showHelp}" title="Help"></button>\n<div collapse=\'!hc.showHelp\' class="panel panel-default help-panel">\n  <div class="panel-heading">Help</div>\n  <div class="panel-body">\n    <h2>General</h2>\n    <div>\n      <div class="icon-inline gear-icon"></div>\n      Settings\n    </div>\n    Access point-cloud settings\n\n    <h2>Navigation</h2>\n    <div>\n      <div>\n        <div class="icon-inline onrails-icon"></div>\n        First-Person Navigation\n      </div>\n      WS: Move back and forth in first-person view Mouse: rotate camera\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline fly-icon"></div>\n        Fly Navigation\n      </div>\n      ASDW or Arrows: Move freely through scene Mouse: rotate camera\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline demo-icon"></div>\n        Play Mode\n      </div>\n      Automically move along a preconfigured demo path\n    </div>\n    <div>\n      <h4>Inspect Mode</h4>\n      <div>When doubleclicking a site, the navigation options switch to \'inspect mode\',\n        this changes the mouse input to \'orbit\' around the selected site and shows\n        the information for this site.</div>\n      <div>\n        <div class="icon-inline back-icon"></div>\n        Exit Inspect Mode\n      </div>\n      When inspecting a specific site, this button can be used to exit\n      the inspect mode and return to the normal controls.\n    </div>\n\n    <h2>Measurement</h2>\n    <div>\n      <div>\n        <div class="icon-inline toolbox-icon"></div>\n        Toolkit\n      </div>\n      Click to open measuring instruments\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline distance-icon"></div>\n        Distance\n      </div>\n      Left Mouse: Insert Measurement Point Right Mouse: Finish insertion Drag&Drop: Move Measurement Points Distance between measurement points will be displayed on the edge.\n\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline area-icon"></div>\n        Surface Area\n      </div>\n      Left Mouse: Insert Measurement Point Right Mouse: Finish insertion Drag&Drop: Move Measurement Points Distance between measurement points will be displayed on the edge and the total area on the centroid. The area is calculated on the ground plane. The\n      height does not affect the result. Crossings should be avoided.\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline volume-icon"></div>\n        Volume\n      </div>\n      Left Mouse: Insert Volume or Select Inserted Volume Switch between translation (icon), scale (icon) and rotation (icon) mode Keyboard shortcut: T, E, R Volume will be displayed on the objects centroid.\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline heightprofile-icon"></div>\n        Height Profile\n      </div>\n      Left Mouse: Insert Profile Marker Right Mouse: Finish insertion Drag&amp;Drop: Move Profile Marker ctrl + Drag&amp;Drop: Drag upwards to increase or downwards to decrease the profile width Depending on the Clip Mode, points inside the profile will be highlighted\n      or points outside the profile will be clipped.\n    </div>\n    <div>\n      <div>\n        <div class="icon-inline clipvolume-icon"></div>\n        Clip Volume\n      </div>\n      Left Mouse: Insert Volume or Select Inserted Volume Switch between translation (icon), scale (icon) and rotation (icon) mode Keyboard shortcut: T, E, R\n    </div>\n\n      <h2>Search Box</h2>\n    <p>\n    In the search box, one can search all (textual) properties of the site\n    objects, plus the site ID-numbers.\n    There are several possibilities for searching.\n    You can search for words or phrases, or use "tags" to search in specific\n    fields.\n    The supported tags are "site:", "condition:", "material:" and "time:".\n    Below we list some example searches.\n    Note that all searches are case-insensitive.\n    </p>\n    <dl>\n      <dt>pyramid</dt>\n      <dd>Searches all textual fields of the site objects for the word "pyramid".</dd>\n\n      <dt>pyramidal monument</dt>\n      <dd>Searches all textual fields of the site objects for the exact phrase\n      "pyramidal monument". Only objects containing this exact phrase will be\n      found! For instance, if the description contains "pyramidal funerary\n      monument", it will not be found by searching for "pyramidal monument".</dd>\n\n      <dt>site:21</dt>\n      <dd>Matched the site_id field of the site objects to the given number (21 in\n      this case).</dd>\n\n      <dt>condition:complete</dt>\n      <dd>Searches the condition field of the site objects for the word "complete"\n      (or "damaged").</dd>\n\n      <dt>material:tufo</dt>\n      <dd>Searches the material fields (material_type, material_subtype and\n      material_technique) of the site objects for the word "tufo" or "peperino".</dd>\n\n      <dt>time:A.D</dt>\n      <dd>Searches the time fields (date_specific and period) of the site objects\n      for the "A.D".</dd>\n\n      <dt>time:2nd time:century</dt>\n      <dd>When looking for multiple words using tags, one needs to add the tag to\n      all words!</dd>\n    </dl>\n\n  </div>\n\n</div>\n'),a.put("scripts/logos/logos.directive.html",'<div class="interface-visible interface-clickable logobox">\n  <a href="http://www.esciencecenter.nl">\n      <img class="logo-custom-nlesc" src="images/ESCIENCE_logo.png" />\n  </a>\n</div>\n'),a.put("scripts/measuring/measuring.directive.html",'<div class="toolbox">\n  <button ng-click="measuring.toggleToolbox()" class="icon-big toolbox-icon" ng-class="{active: measuring.showToolboxTray}"></button>\n</div>\n\n<div class="toolbox-tray tool-icon" collapse=\'!measuring.showToolboxTray\'>\n  <button ng-click="measuring.toggleToolbox()" class="icon-big toolbox-tray-top-icon"></button>\n  <div class="toolbox-tools">\n    <button ng-click="measuring.startDistance()" ng-class="{active: measuring.distanceActive}" class="icon-small distance-icon" title="Start distance measurement"></button>\n    <button ng-click="measuring.startAngle()" ng-class="{active: measuring.angleActive}" class="icon-small angle-icon" title="Start angle measurement"></button>\n    <button ng-click="measuring.startArea()" ng-class="{active: measuring.areaActive}" class="icon-small area-icon" title="Start area measurement"></button>\n    <button ng-click="measuring.startVolume()" ng-class="{active: measuring.volumeActive}" class="icon-small volume-icon" title="Start volume measurement"></button>\n    <button ng-click="measuring.startHeightProfile()" ng-class="{active: measuring.heightProfileActive}" class="icon-small heightprofile-icon" title="Start heightprofile measurement"></button>\n    <button ng-click="measuring.startClipVolume()" ng-class="{active: measuring.clipVolumeActive}" class="icon-small clipvolume-icon" title="Start clip volume measurement"></button>\n  </div>\n</div>\n\n<div class="transformation-toolbox-tray" collapse=\'!measuring.showTransformationToolboxTray\'>\n  <button ng-click="measuring.toggleRotate()" ng-class="{active: measuring.isTransformationRotate()}" class="icon-tiny rotate-icon" title="Change the rotation of the selected area (\'R\' key)"></button>\n  <button ng-click="measuring.toggleTranslate()" ng-class="{active: measuring.isTransformationTranslate()}" class="icon-tiny translate-icon" title="Change the translation of the selected area (\'T\' key)"></button>\n  <button ng-click="measuring.toggleScale()" ng-class="{active: measuring.isTransformationScale()}" class="icon-tiny scale-icon" title="Change the scale of the selected area (\'E\' key)"></button>\n</div>\n'),a.put("scripts/pointcloud/pointcloud-stats.directive.html","<div ng-show='pcs.settings.showStats'>\n<div>Visible points: {{ pcs.stats.nrPoints }}</div>\n<div>Visible nodes: {{ pcs.stats.nrNodes }}</div>\n<div>3D Scene coordinates (x/y/z): {{ pcs.stats.sceneCoordinates.x }}/{{ pcs.stats.sceneCoordinates.y }}/{{ pcs.stats.sceneCoordinates.z }}</div>\n<div>{{ pcs.stats.lasCoordinates.crs }} coordinates (x/y/z): {{ pcs.stats.lasCoordinates.x }}/{{ pcs.stats.lasCoordinates.y }}/{{ pcs.stats.lasCoordinates.z }}</div>\n</div>\n"),a.put("scripts/searchbox/searchbox.directive.html",'<div class="form-group clickable">\n    <div class="input-group">\n        <input type="search" class="form-control" placeholder="Search location..." ng-model="sp.query" ng-keypress="sp.onQueryKeyPress($event)">\n        <span class="input-group-btn">\n          <button class="btn btn-default" type="button" ng-click="sp.clear()" ng-show="sp.query" title="Clear"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>\n          <button class="btn btn-default" type="button" ng-click="sp.search()" ng-disabled="!sp.query" title="Search"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>\n          <button class="btn btn-default" type="button" ng-click="sp.gotoCurrentLocation()" ng-show="sp.hasGeoLocation" title="Current location"><span class="glyphicon glyphicon-home" aria-hidden="true"></span></button>\n        </span>\n    </div>\n</div>\n'),a.put("scripts/settings/settings.directive.html",'<button class="icon-big gear-icon" ng-class="{active: sc.showSettings}" ng-click="sc.showSettings=!sc.showSettings" title="Settings"></button>\n<div class="panel panel-default settings-panel" collapse=\'!sc.showSettings\'>\n    <div class="panel-heading">Settings</div>\n    <div class="panel-body">\n        <tabset>\n            <tab heading="Point">\n                <form class="form-horizontal">\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointCountTarget">\n                            Points(m)</label>\n                        <div class="col-sm-8">\n                            <input class="form-control" id="pointCountTarget" max="10.0" min="0.1" ng-model="sc.settings.pointCountTarget" step="0.1" type="number"/>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointSize">\n                            PointSize\n                        </label>\n                        <div class="col-sm-8">\n                            <input class="form-control" id="pointSize" max="3.0" min="0.01" ng-model="sc.settings.pointSize" step="0.01" type="number"/>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointCountTarget">\n                            Opacity\n                        </label>\n                        <div class="col-sm-8">\n                            <input class="form-control" id="pointCountTarget" max="2.0" min="0.0" ng-model="sc.settings.opacity" step="0.1" type="number"/>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointSizeType">\n                            Size type\n                        </label>\n                        <div class="col-sm-8">\n                            <select class="form-control" id="pointSizeType" ng-model="sc.settings.pointSizeType" ng-options="value as key|lowercase for (key, value) in sc.settings.pointSizeTypes | orderBy:value"></select>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointColorType">\n                            Color type\n                        </label>\n                        <div class="col-sm-8">\n                            <select class="form-control" id="pointColorType" ng-model="sc.settings.pointColorType" ng-options="value as key|lowercase for (key, value) in sc.settings.pointColorTypes | orderBy:value"></select>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="pointShape">\n                            Shape\n                        </label>\n                        <div class="col-sm-8">\n                            <select class="form-control" id="pointShape" ng-model="sc.settings.pointShape" ng-options="value as key|lowercase for (key, value) in sc.settings.pointShapes | orderBy:value"></select>\n                        </div>\n                    </div>\n                </form>\n            </tab>\n            <tab heading="Measurement">\n                <form class="form-horizontal">\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="clipMode">\n                            Clip mode\n                        </label>\n                        <div class="col-sm-8">\n                            <select class="form-control" id="clipMode" ng-model="sc.settings.clipMode" ng-options="value as key|lowercase for (key, value) in sc.settings.clipModes | orderBy:value"></select>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="col-sm-4 control-label" for="profileWidth">\n                            Profile width\n                        </label>\n                        <div class="col-sm-8">\n                            <input class="form-control" id="profileWidth" max="50" min="0.1" ng-model="sc.measure.profileWidth" step="0.1" type="number"/>\n                        </div>\n                    </div>\n                </form>\n            </tab>\n            <tab heading="Misc">\n                <form class="form-horizontal misc">\n                    <div class="checkbox">\n                        <label>\n                            <input ng-model="sc.settings.showSkybox" type="checkbox">\n                            Skybox\n                        </label>\n                    </div>\n                    <div class="checkbox">\n                        <label>\n                            <input ng-model="sc.settings.highQuality" type="checkbox">\n                            High Quality\n                        </label>\n                    </div>\n                    <div class="checkbox">\n                        <label>\n                            <input ng-model="sc.settings.showStats" type="checkbox">\n                            Stats\n                        </label>\n                    </div>\n                    <div class="checkbox">\n                        <label title="Show bounding box of pointcloud octree nodes">\n                            <input ng-model="sc.settings.showBoundingBox" type="checkbox">\n                            Bounding boxes\n                        </label>\n                    </div>\n                    <div class="checkbox">\n                        <label>\n                            <input ng-model="sc.PointcloudService.pathMesh.visible" type="checkbox">\n                            Path\n                        </label>\n                        <button class="btn btn-sm btn-trans glyphicon glyphicon-record" ng-click="sc.recordCameraLocation()" title="Record camera location"></button>\n                    </div>\n                </form>\n            </tab>\n        </tabs>\n    </div>\n</div>\n')}]);